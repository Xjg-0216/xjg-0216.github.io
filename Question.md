
### rtc时钟问题

!!!tip

​	总结： 内核关于RTC驱动设置本身就是启动的，查看开机信息显示初始化设备失败，I2C总线上也分配了地址， 但是并没有成功加载驱动。



### 排查步骤

1. 文件 `/proc/config.gz` 中包含当前内核的配置，通过以下命令`zcat /proc/config.gz > .config`获取配置文件

2. 查看内核设置， 显示`CONFIG_RTC_DRV_HYM8563=y`
表明内核已经启用了 `hym8563` RTC 驱动，并且它是直接集成进内核的，而不是作为一个模块。所以当手动尝试加载时报错：
```bash
rpdzkj@ubuntu2004:~$ sudo modprobe rtc-hym8563                         
modprobe: FATAL: Module rtc-hym8563 not found in directory /lib/modules/5.10.198
```

3. 检查 RTC 驱动是否已经加载
使用 `dmesg | grep rtc` 命令查看是否有相关的日志，确认 `hym8563` 驱动是否已加载
```bash
rpdzkj@ubuntu2004:~$ dmesg | grep -i rtc                               
[    5.943375] rtc-hym8563 4-0051: could not init device, -6
```
`hym8563` RTC 驱动未能成功初始化设备，错误代码为 `-6`，硬件初始化失败。


通过 `i2cdetect -y 1` 命令查看 I2C 总线上是否能检测到 `rtc-hym8563` 设备。
```bash
rpdzkj@ubuntu2004:~$ sudo i2cdetect -y 1
     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
00:          -- -- -- -- -- -- -- -- -- -- -- -- -- 
10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
40: -- -- UU -- -- -- -- -- -- -- -- -- -- -- -- -- 
50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
70: -- -- -- -- -- -- -- -- 
```
地址 `0x51` 被内核分配（显示为 `UU`）。

